<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>payroll</title>

    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
        *{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Times New Roman', Times, serif;
        }

        body{
            display: grid;
            grid-template-areas: "sidebar header"
            "sidebar main";
            grid-template-columns: 200px 1fr;
            grid-template-rows: auto 1fr;
            min-height: 100vh;

        }
        nav{
            grid-area: sidebar;
             background-color: #455A64;
            color: white;
            padding-top: 40px;
        }

   nav ul{
    list-style: none;
    margin: 0;
    padding: 0;
   }     

   nav li {
  padding: 15px 20px;
  cursor: pointer;
}


nav li{
    display: flex;
    gap: 5%;
}


nav li.active {
 color: #F8CC14;
}
nav li a{
  color: white;
  text-decoration: none;
}

nav li:hover {
  background-color: #37474F;
}

nav li a{
    display: flex;
    gap: 5%;
    align-items: baseline;
} 


 header{
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    /* gap: 5%; */
 }

 header .mnth{
    padding: 10px;
    background-color: #455A64;
    color: white;
    border-radius: 5px;
    cursor: pointer;
    border: none;
    font-weight: bold;
    
 }

 header .dwnld{
    padding: 10px;
    background-color: #F8CC14;
    color: black;
    font-weight: bold;
    border: none;
    border-radius: 5px;
    cursor: pointer;

 }

 main{
    padding: 10px;
 }

 form{
    padding: 5%;
    background-color: #FEEBAD;
 }

 .form-details{
      display: grid;
 grid-template-columns: 1fr 1fr 1fr;
 }
form section{
    margin-top: 2%;
}
 form input{
    padding: 8px;
    background-color:#FEEBAD;
    border: 1px solid black;
    margin-top: 2%;
    border-radius: 5px;
 }

 form input:focus{
    border: 1px solid black;
     outline: none; /* Optional: remove default blue glow */
    transition: border-color 0.3s ease;
 }

 /* form label{
    font-weight: bold;
 } */

/* Remove spinner in Chrome, Safari, Edge */
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  appearance: none;
  margin: 0;
}

/* Remove spinner in Firefox */
input[type="number"] {
  -moz-appearance: textfield;
}

form section.submit-cancel{
    margin-top: 5%;
    display: flex;
    gap: 5%;
    justify-content: center;

}

form section.submit-cancel button{
    padding: 8px 25px;
    border-radius: 5px;
    cursor: pointer;
}

form section .submit{
    background-color: #F8CC14;
    color: black;
    border: none;
}

form section .cancel{
    background-color: #455A64;
    color: white;
    border: none;
    padding: 8px 35px !important;
}

        @media (max-width: 1024px) {
  .form-details {
    grid-template-columns: 1fr 1fr;
  }
}

@media (max-width: 768px) {
  body {
    display: block;
  }

  nav {
    width: 100%;
    padding-top: 10px;
  }

  nav ul {
    display: flex;
    flex-direction: row;
    justify-content: space-around;
    flex-wrap: wrap;
  }

  nav li {
    flex: 1 1 auto;
    text-align: center;
    padding: 10px 5px;
  }

  header {
    flex-direction: column;
    align-items: flex-start;
    gap: 10px;
  }

  .form-details {
    grid-template-columns: 1fr;
  }

  form {
    padding: 10px;
  }

  form section.submit-cancel {
    flex-direction: column;
    gap: 10px;
  }

  form section .cancel {
    padding: 8px 25px !important;
  }

  .mnth-dwnld {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .dwnld, .mnth {
    width: 100%;
  }
}


        
    </style>

</head>
<body>

     <nav>
    <ul>
      <li><a href="./overview.html"><i class="fa-solid fa-palette"></i>Overview</a></li>
      <li class="active"><i class="fa-solid fa-file-invoice-dollar"></i>Payroll</li>
      <li><i class="fa-solid fa-file-invoice-dollar"></i> Payslip</li>
    </ul>
  </nav>

  <main>
    <header>
    <h2>Payroll Details</h2>

    <section class="mnth-dwnld">
        <button class="mnth">This Month <i class="fa-solid fa-calendar-days"></i></button>
        
        <button class="dwnld">Download</button>
    </section>
</header>

<form class="content">
    <div class="form-details">
    <section>
        <label for="emp-name">Employee Name</label> <br>
        <input type="text" name="emp-name" id="emp-name" required>
    </section>

    <section>
        <label for="emp-role">Employee Role</label> <br>
        <input type="text" name="emp-role" id="emp-role" required>
    </section>

    <section>
        <label for="emp-id">Employee ID</label> <br>
        <input type="number" name="emp-id" id="emp-id" required>
      

    </section>

    <section>
        <label for="date">Date</label> <br>
        <input type="date" name="date" id="date" required>
    </section>

     <section>
        <label for="emp-basic-sal">Basic Salary</label> <br>
        <input type="number" name="emp-basic-sal" id="emp-basic-sal" required>
    </section>

     <section>
        <label for="emp-tot-sal">Total Salary</label> <br>
        <input type="number" name="emp-tot-sal" id="emp-tot-sal" readonly>
    </section>

     <section>
        <label for="emp-working-days">No.of Working Days</label> <br>
       <input type="number" name="emp-working-days" id="emp-working-days" readonly>

    </section>

     <section>
        <label for="emp-pres-days">Total Present Days</label> <br>
        <input type="number" name="emp-pres-days" id="emp-pres-days" required>
    </section>

     <section>
        <label for="emp-leave">Total Leave Days</label> <br>
        <input type="number" name="emp-leave" id="emp-leave" readonly>
    </section>

     <section>
        <label for="emp-addition">Additions</label> <br>
        <input type="number" name="emp-addition" id="emp-addition" >
    </section>

     <section>
        <label for="emp-ded">Deductions</label> <br>
        <input type="number" name="emp-ded" id="emp-ded" readonly>
    </section>

    <section style="display: none">
        <label for="emp-original-totalsal">Original salary</label>
        <input type="number" name="emp-original-totalsal" id="emp-original-totalsal" readonly>
    </section>

    <section style="display: block;">
        <label for="totalearnings">Total earnings</label> <br>
        <input type="number" name="totalearnings" id="total-earnings" readonly>
    </section>
 </div>

    <section class="submit-cancel">
        <button type="submit" class="submit" id="submit">Submit Payroll</button>
        <button class="cancel" id="cancel">Cancel</button>
    </section>

 </form>
  </main>

 <script>


  let empName, empRole, empId, date, empbasicSal, empTotSal;
  let empWorkingDays, empPresDays, empLeave, empAddition, empDed,empOrigTotalSal;


    empName = document.getElementById("emp-name").value;
    empRole = document.getElementById("emp-role").value;
    empId = document.getElementById("emp-id").value;
    date = document.getElementById("date").value;
    
    empTotSal = document.getElementById("emp-tot-sal").value;
    empLeave = document.getElementById("emp-leave").value;
    empDed = document.getElementById("emp-ded").value;
    let emptotearnings=document.getElementById("total-earnings").value;
    empOrigTotalSal = document.getElementById("emp-original-totalsal").value;

 // Convert input strings to numbers

 function calculatePayroll(){

    empbasicSal = parseFloat(document.getElementById("emp-basic-sal").value) || 0;
    empWorkingDays = parseFloat(document.getElementById("emp-working-days").value) || 0;
    empPresDays = parseFloat(document.getElementById("emp-pres-days").value) || 0;
    empAddition = parseFloat(document.getElementById("emp-addition").value) || 0;


    empLeave= empWorkingDays-empPresDays; 
    document.getElementById("emp-leave").value= empLeave;
    empDed=empLeave*empbasicSal;
    document.getElementById("emp-ded").value =empDed ;
    empTotSal= (empPresDays* empbasicSal);
     document.getElementById("emp-tot-sal").value=empTotSal;


 empOrigTotalSal=empbasicSal*empPresDays;
   document.getElementById("emp-original-totalsal").value=empOrigTotalSal;

     emptotearnings=empOrigTotalSal+empAddition;
     document.getElementById("total-earnings").value=emptotearnings;

if (empPresDays > empWorkingDays) {
  alert("Present days cannot be greater than working days.");
  document.getElementById("emp-pres-days").value = empWorkingDays;
  empPresDays = empWorkingDays;
}

  document.querySelector(".mnth").addEventListener("click", function (e) {
    e.preventDefault();

    const today = new Date();
    const month = today.getMonth(); // 0 = Jan
    const year = today.getFullYear();

    const daysInMonth = new Date(year, month + 1, 0).getDate(); // Last day of month
    let workingDays = 0;

    for (let day = 1; day <= daysInMonth; day++) {
        const date = new Date(year, month, day);
        if (date.getDay() !== 0) { // 0 = Sunday
            workingDays++;
        }
    }

    // Autofill date with today's date if not already filled
    const dateInput = document.getElementById("date");
    if (!dateInput.value) {
        const isoDate = today.toISOString().split("T")[0];
        dateInput.value = isoDate;
    }

    document.getElementById("emp-working-days").value = workingDays;
    calculatePayroll();
});
     
 }


 document.getElementById("emp-basic-sal").addEventListener("input", calculatePayroll);
//  document.getElementById("emp-working-days").addEventListener("input", calculatePayroll);
// Auto-set working days based on selected date
document.getElementById("date").addEventListener("change", function () {
    const dateValue = this.value;
    if (!dateValue) return;

    const dateObj = new Date(dateValue);
    const month = dateObj.getMonth(); // 0-indexed: Jan = 0
    const year = dateObj.getFullYear();

    let workingDays = 31;
    if ([3, 5, 8, 10].includes(month)) {
        workingDays = 30; // April, June, September, November
    } else if (month === 1) {
        // February
        workingDays = (year % 4 === 0 && (year % 100 !== 0 || year % 400 === 0)) ? 29 : 28;
    }

    document.getElementById("emp-working-days").value = workingDays;
    calculatePayroll();
});

 document.getElementById("emp-pres-days").addEventListener("input", calculatePayroll);
 document.getElementById("emp-addition").addEventListener("input", calculatePayroll);


         document.querySelector("form").addEventListener("submit", function (e) {
         e.preventDefault();
  

     const empData = {
      name: document.getElementById("emp-name").value,
      role: document.getElementById("emp-role").value,
      id: document.getElementById("emp-id").value,
      date: document.getElementById("date").value,
      basicSal: document.getElementById("emp-basic-sal").value,

      totalSal: document.getElementById("emp-tot-sal").value,

      addition: document.getElementById("emp-addition").value,
      deduction: document.getElementById("emp-ded").value,

      totalearnings: document.getElementById("total-earnings").value,
       
      totalworkingdays:document.getElementById("emp-working-days").value,
      leavedays:document.getElementById("emp-leave").value,
      presentdays: document.getElementById("emp-pres-days").value,


      originalsalary:document.getElementById("emp-original-totalsal").value,
    };


    localStorage.setItem("empPayrollData",JSON.stringify(empData));
    window.location.href="payslip.html"
    });
 
</script>

 </body>
 </html>